@page
@model EncryptionModel
@{
    ViewData["Title"] = "Encrypt / Decrypt";
    var activeAesTab = ViewData["ActiveAesTab"] as string ?? "encrypt";
    var activeRsaTab = ViewData["ActiveRsaTab"] as string ?? "encrypt";
}

<div class="container mx-auto px-4 py-8">
    <h1 class="text-4xl font-bold text-center mb-8 text-gradient">Encrypt / Decrypt</h1>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- AES Card -->
        <div class="card">
            <h2 class="text-2xl font-semibold mb-4 text-green-400">AES</h2>
            <div>
                <ul class="flex mb-4 border-b border-purple-500">
                    <li class="mr-4">
                        <button type="button" class="tab-aes-encrypt px-4 py-2 @(activeAesTab=="encrypt" ? "text-green-400 border-b-2 border-green-400" : "text-green-400 border-b-2 border-transparent") focus:outline-none">Encrypt</button>
                    </li>
                    <li>
                        <button type="button" class="tab-aes-decrypt px-4 py-2 @(activeAesTab=="decrypt" ? "text-purple-400 border-b-2 border-purple-400" : "text-purple-400 border-b-2 border-transparent") focus:outline-none">Decrypt</button>
                    </li>
                </ul>
                <div class="aes-encrypt-form @(activeAesTab=="encrypt" ? "" : "hidden")">
                    <form method="post" enctype="multipart/form-data" asp-page-handler="AES">
                        <!-- RSA state'ini korumak için hidden inputlar (formun en başında) -->
                        <input type="hidden" name="RSAKeySize" value="@Model.RSAKeySize" />
                        <input type="hidden" name="RSAPadding" value="@Model.RSAPadding" />
                        <input type="hidden" name="RSAPublicKey" value="@Model.RSAPublicKey" />
                        <input type="hidden" name="RSAPrivateKey" value="@Model.RSAPrivateKey" />
                        <input type="hidden" name="RSAEncrypted" value="@Model.RSAEncrypted" />
                        <input type="hidden" name="RSADecrypted" value="@Model.RSADecrypted" />
                        @if (ViewData["AES_Error"] != null)
                        {
                            <div class="mb-4 p-2 bg-red-900 text-red-300 rounded">@ViewData["AES_Error"]</div>
                        }
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Şifreleme Modu</label>
                                <select name="AESMode" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.AESMode == "CBC")
                                    {
                                        <option value="CBC" selected>CBC (Güvenli blok zinciri modu)</option>
                                    }
                                    else
                                    {
                                        <option value="CBC">CBC (Güvenli blok zinciri modu)</option>
                                    }
                                    @if (Model.AESMode == "ECB")
                                    {
                                        <option value="ECB" selected>ECB (Uyarı: Daha az güvenli)</option>
                                    }
                                    else
                                    {
                                        <option value="ECB">ECB (Uyarı: Daha az güvenli)</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Anahtar Boyutu</label>
                                <select name="AESKeySize" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.AESKeySize == 128)
                                    {
                                        <option value="128" selected>128-bit</option>
                                    }
                                    else
                                    {
                                        <option value="128">128-bit</option>
                                    }
                                    @if (Model.AESKeySize == 256)
                                    {
                                        <option value="256" selected>256-bit</option>
                                    }
                                    else
                                    {
                                        <option value="256">256-bit</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Padding Modu</label>
                                <select name="AESPadding" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.AESPadding == "PKCS7")
                                    {
                                        <option value="PKCS7" selected>PKCS7 (Standart dolgu yöntemi)</option>
                                    }
                                    else
                                    {
                                        <option value="PKCS7">PKCS7 (Standart dolgu yöntemi)</option>
                                    }
                                    @if (Model.AESPadding == "None")
                                    {
                                        <option value="None" selected>None</option>
                                    }
                                    else
                                    {
                                        <option value="None">None</option>
                                    }
                                    @if (Model.AESPadding == "Zeros")
                                    {
                                        <option value="Zeros" selected>Zeros</option>
                                    }
                                    else
                                    {
                                        <option value="Zeros">Zeros</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Metin</label>
                                <div class="relative">
                                    <textarea name="AESText" class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white pr-20" placeholder="Şifrelenecek metni girin...">@Model.AESText</textarea>
                                    <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                        <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="AESText" title="Yapıştır">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Anahtar</label>
                                <div class="flex space-x-2 items-center">
                                    <div class="relative flex-1">
                                        <input name="AESKey" type="text" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white pr-12" placeholder="Anahtar" value="@Model.AESKey">
                                        <div class="absolute inset-y-0 right-2 flex items-center">
                                            <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="AESKey" title="Yapıştır">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <button type="submit" name="AESGenerateKey" value="1" class="btn-primary">Yeni Anahtar</button>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">IV (Initialization Vector)</label>
                                <div class="flex space-x-2 items-center">
                                    <div class="relative flex-1">
                                        <input name="AESIV" type="text" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white pr-12" placeholder="IV" value="@Model.AESIV">
                                        <div class="absolute inset-y-0 right-2 flex items-center">
                                            <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="AESIV" title="Yapıştır">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <button type="submit" name="AESGenerateIV" value="1" class="btn-primary">Yeni IV</button>
                                </div>
                            </div>
                            <button type="submit" class="w-full btn-primary">Şifrele</button>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Şifreli Sonuç</label>
                            <div class="relative">
                                <textarea class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white font-mono pr-20" readonly>@Model.AESEncrypted</textarea>
                                <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                    <button type="button" class="copy-btn p-2 text-gray-400 hover:text-purple-400" data-target="aes-encrypted" title="Kopyala">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                        </svg>
                                    </button>
                                    <button type="button" class="p-2 text-gray-400 hover:text-purple-400 transition-colors bg-transparent download-btn" title="İndir">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="aes-decrypt-form @(activeAesTab=="decrypt" ? "" : "hidden")">
                    <form method="post" enctype="multipart/form-data" asp-page-handler="AESDecrypt">
                        <!-- RSA state'ini korumak için hidden inputlar (formun en başında) -->
                        <input type="hidden" name="RSAKeySize" value="@Model.RSAKeySize" />
                        <input type="hidden" name="RSAPadding" value="@Model.RSAPadding" />
                        <input type="hidden" name="RSAPublicKey" value="@Model.RSAPublicKey" />
                        <input type="hidden" name="RSAPrivateKey" value="@Model.RSAPrivateKey" />
                        <input type="hidden" name="RSAEncrypted" value="@Model.RSAEncrypted" />
                        <input type="hidden" name="RSADecrypted" value="@Model.RSADecrypted" />
                        @if (ViewData["AES_Error"] != null)
                        {
                            <div class="mb-4 p-2 bg-red-900 text-red-300 rounded">@ViewData["AES_Error"]</div>
                        }
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Şifreli Metin</label>
                                <div class="relative">
                                    <textarea name="AESEncrypted" class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white pr-20" placeholder="Şifreli metni girin...">@Model.AESEncrypted</textarea>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Şifreleme Modu</label>
                                <select name="AESMode" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.AESMode == "CBC")
                                    {
                                        <option value="CBC" selected>CBC (Güvenli blok zinciri modu)</option>
                                    }
                                    else
                                    {
                                        <option value="CBC">CBC (Güvenli blok zinciri modu)</option>
                                    }
                                    @if (Model.AESMode == "ECB")
                                    {
                                        <option value="ECB" selected>ECB (Uyarı: Daha az güvenli)</option>
                                    }
                                    else
                                    {
                                        <option value="ECB">ECB (Uyarı: Daha az güvenli)</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Anahtar Boyutu</label>
                                <select name="AESKeySize" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.AESKeySize == 128)
                                    {
                                        <option value="128" selected>128-bit</option>
                                    }
                                    else
                                    {
                                        <option value="128">128-bit</option>
                                    }
                                    @if (Model.AESKeySize == 256)
                                    {
                                        <option value="256" selected>256-bit</option>
                                    }
                                    else
                                    {
                                        <option value="256">256-bit</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Padding Modu</label>
                                <select name="AESPadding" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.AESPadding == "PKCS7")
                                    {
                                        <option value="PKCS7" selected>PKCS7 (Standart dolgu yöntemi)</option>
                                    }
                                    else
                                    {
                                        <option value="PKCS7">PKCS7 (Standart dolgu yöntemi)</option>
                                    }
                                    @if (Model.AESPadding == "None")
                                    {
                                        <option value="None" selected>None (Dolgu yok)</option>
                                    }
                                    else
                                    {
                                        <option value="None">None (Dolgu yok)</option>
                                    }
                                    @if (Model.AESPadding == "Zeros")
                                    {
                                        <option value="Zeros" selected>Zeros (Sıfır dolgu)</option>
                                    }
                                    else
                                    {
                                        <option value="Zeros">Zeros (Sıfır dolgu)</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Anahtar</label>
                                <div class="flex space-x-2 items-center">
                                    <div class="relative flex-1">
                                        <input name="AESKey" type="text" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white pr-12" placeholder="Anahtar" value="@Model.AESKey">
                                        <div class="absolute inset-y-0 right-2 flex items-center">
                                            <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="AESKey" title="Yapıştır">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">IV (Initialization Vector)</label>
                                <div class="relative">
                                    <input name="AESIV" type="text" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white pr-20" placeholder="IV" value="@Model.AESIV">
                                    <div class="absolute inset-y-0 right-2 flex items-center">
                                        <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="AESIV" title="Yapıştır">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="w-full btn-primary">Çöz</button>
                        </div>
                        <div class="mt-6">
                            <label class="block text-sm font-medium text-gray-400 mb-2">Çözülmüş Sonuç</label>
                            <div class="relative">
                                <textarea class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white font-mono" readonly>@Model.AESDecrypted</textarea>
                                <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                    <button type="button" class="p-2 text-gray-400 hover:text-purple-400 transition-colors bg-transparent" title="Kopyala">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                        </svg>
                                    </button>
                                    <button type="button" class="p-2 text-gray-400 hover:text-purple-400 transition-colors bg-transparent download-btn" title="İndir">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- RSA Card -->
        <div class="card">
            <h2 class="text-2xl font-semibold mb-4 text-fuchsia-400">RSA</h2>
            <div>
                <ul class="flex mb-4 border-b border-purple-500">
                    <li class="mr-4">
                        <button type="button" class="tab-rsa-encrypt px-4 py-2 @(activeRsaTab=="encrypt" ? "text-fuchsia-400 border-b-2 border-fuchsia-400" : "text-fuchsia-400 border-b-2 border-transparent") focus:outline-none">Encrypt</button>
                    </li>
                    <li>
                        <button type="button" class="tab-rsa-decrypt px-4 py-2 @(activeRsaTab=="decrypt" ? "text-purple-400 border-b-2 border-purple-400" : "text-purple-400 border-b-2 border-transparent") focus:outline-none">Decrypt</button>
                    </li>
                </ul>
                <div class="rsa-encrypt-form @(activeRsaTab=="encrypt" ? "" : "hidden")">
                    <form method="post" enctype="multipart/form-data" asp-page-handler="RSA">
                        <!-- AES state'ini korumak için hidden inputlar (formun en başında) -->
                        <input type="hidden" name="AESMode" value="@Model.AESMode" />
                        <input type="hidden" name="AESPadding" value="@Model.AESPadding" />
                        <input type="hidden" name="AESKeySize" value="@Model.AESKeySize" />
                        <input type="hidden" name="AESText" value="@Model.AESText" />
                        <input type="hidden" name="AESKey" value="@Model.AESKey" />
                        <input type="hidden" name="AESIV" value="@Model.AESIV" />
                        <input type="hidden" name="AESEncrypted" value="@Model.AESEncrypted" />
                        <input type="hidden" name="AESDecrypted" value="@Model.AESDecrypted" />
                        @if (ViewData["RSA_Error"] != null)
                        {
                            <div class="mb-4 p-2 bg-red-900 text-red-300 rounded">@ViewData["RSA_Error"]</div>
                        }
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Anahtar Uzunluğu</label>
                                <select name="RSAKeySize" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.RSAKeySize == 2048)
                                    {
                                        <option value="2048" selected>2048-bit (Standart)</option>
                                    }
                                    else
                                    {
                                        <option value="2048">2048-bit (Standart)</option>
                                    }
                                    @if (Model.RSAKeySize == 4096)
                                    {
                                        <option value="4096" selected>4096-bit (Yüksek güvenlik)</option>
                                    }
                                    else
                                    {
                                        <option value="4096">4096-bit (Yüksek güvenlik)</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Padding Şeması</label>
                                <select name="RSAPadding" class="w-full bg-gray-900 border border-purple-500 rounded p-2 text-white">
                                    @if (Model.RSAPadding == "OAEP")
                                    {
                                        <option value="OAEP" selected>RSA-OAEP (Modern ve güvenli)</option>
                                    }
                                    else
                                    {
                                        <option value="OAEP">RSA-OAEP (Modern ve güvenli)</option>
                                    }
                                    @if (Model.RSAPadding == "PKCS1")
                                    {
                                        <option value="PKCS1" selected>PKCS#1 v1.5 (Geriye uyumlu)</option>
                                    }
                                    else
                                    {
                                        <option value="PKCS1">PKCS#1 v1.5 (Geriye uyumlu)</option>
                                    }
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Public Key</label>
                                <div class="relative">
                                    <textarea name="RSAPublicKey" class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white pr-20" placeholder="Public key'i girin...">@Model.RSAPublicKey</textarea>
                                    <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                        <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="RSAPublicKey" title="Yapıştır">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Metin</label>
                                <div class="relative">
                                    <textarea name="RSAText" class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white pr-20" placeholder="Şifrelenecek metni girin...">@Model.RSAText</textarea>
                                    <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                        <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="RSAText" title="Yapıştır">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="w-full btn-primary">Şifrele</button>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Şifreli Sonuç</label>
                            <div class="relative">
                                <textarea class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white font-mono pr-20" readonly>@Model.RSAEncrypted</textarea>
                                <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                    <button type="button" class="copy-btn p-2 text-gray-400 hover:text-purple-400" data-target="rsa-encrypted" title="Kopyala">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                        </svg>
                                    </button>
                                    <button type="button" class="p-2 text-gray-400 hover:text-purple-400 transition-colors bg-transparent download-btn" title="İndir">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="rsa-decrypt-form @(activeRsaTab=="decrypt" ? "" : "hidden")">
                    <form method="post" enctype="multipart/form-data" asp-page-handler="RSADecrypt">
                        <!-- AES state'ini korumak için hidden inputlar (formun en başında) -->
                        <input type="hidden" name="AESMode" value="@Model.AESMode" />
                        <input type="hidden" name="AESPadding" value="@Model.AESPadding" />
                        <input type="hidden" name="AESKeySize" value="@Model.AESKeySize" />
                        <input type="hidden" name="AESText" value="@Model.AESText" />
                        <input type="hidden" name="AESKey" value="@Model.AESKey" />
                        <input type="hidden" name="AESIV" value="@Model.AESIV" />
                        <input type="hidden" name="AESEncrypted" value="@Model.AESEncrypted" />
                        <input type="hidden" name="AESDecrypted" value="@Model.AESDecrypted" />
                        @if (ViewData["RSA_Error"] != null)
                        {
                            <div class="mb-4 p-2 bg-red-900 text-red-300 rounded">@ViewData["RSA_Error"]</div>
                        }
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Şifreli Metin</label>
                                <div class="relative">
                                    <textarea name="RSAEncrypted" class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white pr-20" placeholder="Şifreli metni girin...">@Model.RSAEncrypted</textarea>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-400 mb-2">Private Key</label>
                                <div class="relative">
                                    <textarea name="RSAPrivateKey" class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white pr-20" placeholder="Private key'i girin...">@Model.RSAPrivateKey</textarea>
                                    <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                        <button type="button" class="paste-btn p-2 text-gray-400 hover:text-purple-400" data-target="RSAPrivateKey" title="Yapıştır">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="w-full btn-primary">Çöz</button>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Çözülmüş Sonuç</label>
                            <div class="relative">
                                <textarea class="w-full h-32 bg-gray-900 border border-purple-500 rounded p-2 text-white font-mono pr-20" readonly>@Model.RSADecrypted</textarea>
                                <div class="absolute bottom-2 right-2 flex flex-row items-end space-x-2">
                                    <button type="button" class="copy-btn p-2 text-gray-400 hover:text-purple-400" data-target="rsa-decrypted" title="Kopyala">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                        </svg>
                                    </button>
                                    <button type="button" class="p-2 text-gray-400 hover:text-purple-400 transition-colors bg-transparent download-btn" title="İndir">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
    // Tab switching logic for AES
    document.querySelector('.tab-aes-encrypt').onclick = function() {
        document.querySelector('.aes-encrypt-form').classList.remove('hidden');
        document.querySelector('.aes-decrypt-form').classList.add('hidden');
        this.classList.add('border-green-400', 'text-green-400');
        document.querySelector('.tab-aes-decrypt').classList.remove('border-purple-400', 'text-purple-400');
        sessionStorage.setItem('activeAesTab', 'encrypt');
    };
    document.querySelector('.tab-aes-decrypt').onclick = function() {
        document.querySelector('.aes-encrypt-form').classList.add('hidden');
        document.querySelector('.aes-decrypt-form').classList.remove('hidden');
        this.classList.add('border-purple-400', 'text-purple-400');
        document.querySelector('.tab-aes-encrypt').classList.remove('border-green-400', 'text-green-400');
        sessionStorage.setItem('activeAesTab', 'decrypt');
    };
    // Tab switching logic for RSA
    document.querySelector('.tab-rsa-encrypt').onclick = function() {
        document.querySelector('.rsa-encrypt-form').classList.remove('hidden');
        document.querySelector('.rsa-decrypt-form').classList.add('hidden');
        this.classList.add('border-fuchsia-400', 'text-fuchsia-400');
        document.querySelector('.tab-rsa-decrypt').classList.remove('border-purple-400', 'text-purple-400');
        sessionStorage.setItem('activeRsaTab', 'encrypt');
    };
    document.querySelector('.tab-rsa-decrypt').onclick = function() {
        document.querySelector('.rsa-encrypt-form').classList.add('hidden');
        document.querySelector('.rsa-decrypt-form').classList.remove('hidden');
        this.classList.add('border-purple-400', 'text-purple-400');
        document.querySelector('.tab-rsa-encrypt').classList.remove('border-fuchsia-400', 'text-fuchsia-400');
        sessionStorage.setItem('activeRsaTab', 'decrypt');
    };
    // On page load, restore tab state
    window.onload = function() {
        var aesTab = sessionStorage.getItem('activeAesTab');
        var rsaTab = sessionStorage.getItem('activeRsaTab');
        if (aesTab === 'decrypt') {
            document.querySelector('.tab-aes-decrypt').click();
        }
        if (rsaTab === 'decrypt') {
            document.querySelector('.tab-rsa-decrypt').click();
        }
    };
    // Kopyala ve indir scripti
    document.querySelectorAll('.copy-btn').forEach(function(btn) {
        btn.onclick = function() {
            var textarea = btn.closest('.relative').querySelector('textarea');
            if (textarea) {
                navigator.clipboard.writeText(textarea.value);
            }
        };
    });
    document.querySelectorAll('.download-btn').forEach(function(btn) {
        btn.onclick = function(event) {
            event.preventDefault();
            event.stopPropagation();
            if (event.stopImmediatePropagation) event.stopImmediatePropagation();
            var textarea = btn.closest('.relative').querySelector('textarea');
            if (textarea && textarea.value.trim() !== "") {
                var blob = new Blob([textarea.value], {type: 'text/plain'});
                var url = URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = 'sonuc.txt';
                document.body.appendChild(a);
                a.click();
                setTimeout(function() {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
            }
        };
    });
    // Yapıştırma scripti
    document.querySelectorAll('.paste-btn').forEach(function(btn) {
        btn.onclick = function() {
            var container = btn.closest('.relative');
            var input = container ? container.querySelector('input, textarea') : null;
            if (input) {
                navigator.clipboard.readText().then(function(text) {
                    input.value = text;
                });
            }
        };
    });
</script>
} 